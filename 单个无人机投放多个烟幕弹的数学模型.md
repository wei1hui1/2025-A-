# 无人机 FY1 投放 3 枚烟幕干扰弹的数学模型

## 一、符号与已知常量
- **导弹参数**
  - 初始位置：$\mathbf{M}_0=(20000,0,2000)$  
  - 飞行速度：$v_m=300 \,\text{m/s}$  
  - 飞行轨迹：  
    $$
    \mathbf{M}(t)=\mathbf{M}_0+v_m t \mathbf{u}_m
    $$
    其中 $\mathbf{u}_m=\dfrac{\mathbf{O}-\mathbf{M}_0}{\|\mathbf{O}-\mathbf{M}_0\|}$，$\mathbf{O}$ 为假目标坐标。

- **无人机参数**
  - 初始位置：$\mathbf{F}=(17800,0,1800)$  
  - 飞行速度：$v \in [70,140] \,\text{m/s}$  
  - 航向单位向量：$\mathbf{h}=(\cos\theta,\sin\theta,0)$  
  - 轨迹：  
    $$
    \mathbf{U}(t)=\mathbf{F}+v\,t\,\mathbf{h}
    $$

- **烟幕干扰弹（第 $i$ 枚，$i=1,2,3$）**
  - 释放时刻：$t_{r,i}$  
  - 延迟起爆：$t_{d,i}$  
  - 起爆时刻：$t_{e,i}=t_{r,i}+t_{d,i}$  
  - 起爆点：  
    $$
    \mathbf{P}_i=\mathbf{U}(t_{r,i}) + v\mathbf{h}t_{d,i} - \tfrac{1}{2}g t_{d,i}^2 \mathbf{e}_z
    $$
  - 云团半径：$R_c=10\,\text{m}$  
  - 下沉速度：$w=3\,\text{m/s}$  
  - 持续时间：$T_c=20\,\text{s}$  
  - 云团中心运动：  
    $$
    \mathbf{C}_i(t)=\mathbf{P}_i - w(t-t_{e,i})\mathbf{e}_z, 
    \quad t\in[t_{e,i},t_{e,i}+T_c]
    $$

- **约束条件**
  - 同一无人机两次投放间隔：  
    $$
    |t_{r,i}-t_{r,j}|\ge1,\quad \forall i\neq j
    $$

---

## 二、遮蔽判据

- 设真目标圆心 $P_T$ 与导弹位置 $M(t)$，定义导弹—目标连线段：
  $$
  L(t) = \{ P_T + \lambda (M(t) - P_T) \mid 0 \leq \lambda \leq 1 \}.
  $$
- 云团中心到该线段的最小距离：
  $$
  d(t) = \min_{i=1,2,3} \{\min_{\lambda \in [0,1]} \| \mathbf{C}_i(t) - (P_T + \lambda (M(t)-P_T)) \|\}.
  $$
- 遮蔽判定条件：
  $$
  d(t) \leq R_c\ \ ; \ \ t \ge T_c
  $$
---

## 三、目标函数
定义遮蔽指示函数：
$$
\mathbb{I}_i(t)=
\begin{cases}
1, & \text{若云团 $i$ 在时刻 $t$ 遮蔽导弹}\\
0, & \text{否则}
\end{cases}
$$

总遮蔽时间（并集时长）为：
$$
J=\int_{0}^{t_{\text{hit}}} 
\mathbf{1}\!\left(\sum_{i=1}^3 \mathbb{I}_i(t)\ge 1\right) dt
$$
其中 $t_{\text{hit}}$ 为导弹击中假目标所需时间。

---

## 四、优化模型
**决策变量**：
- 无人机速度 $v$ 与航向 $\theta$  
- 每枚弹的释放时刻 $t_{r,i}$ 与延迟 $t_{d,i}$

**优化问题**：
$$
\begin{aligned}
\max_{v,\theta,t_{r,i},t_{d,i}} \quad & J \\
\text{s.t.}\quad 
& v_{\min}\le v \le v_{\max} \\
& t_{r,i}\ge0,\; t_{d,i}>0,\; t_{e,i}=t_{r,i}+t_{d,i}\le t_{\text{hit}} \\
& |t_{r,i}-t_{r,j}|\ge1,\;\forall i\neq j
\end{aligned}
$$

---

## 五、离散化近似（便于 MILP 建模）
- 时间网格化：$t_k=k\Delta t$  
- 二进制变量：
  - $x_{i,k}=1$ 表示第 $i$ 枚弹在时刻 $t_k$ 起爆  
  - $y_k=1$ 表示时刻 $t_k$ 被至少一枚云团遮蔽
- 目标函数：  
  $$
  \max \sum_k y_k \Delta t
  $$


