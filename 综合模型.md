# 问题 5 数学模型（5 架无人机，每架最多 3 枚干扰弹，干扰来袭导弹 M1,M2,M3）

## 1. 符号与常量（统一）
- 参考系：假目标原点 $\mathbf{O}=(0,0,0)$，真目标圆心 $\mathbf{T}=(0,200,0)$。  
- 导弹集合：$\mathcal{M}=\{1,2,3\}$，第 $j$ 枚导弹初始位置 $\mathbf{M}_{0j}$ 与速度 $v_{m,j}$（题中 $v_{m,j}=300\ \mathrm{m/s}$ 等）。导弹轨迹：
  $$
  \mathbf{M}_j(t)=\mathbf{M}_{0j} + v_{m,j}\,t\,\mathbf{u}_{m,j},\quad
  \mathbf{u}_{m,j}=\frac{\mathbf{O}-\mathbf{M}_{0j}}{\|\mathbf{O}-\mathbf{M}_{0j}\|}.
  $$
- 无人机集合：$\mathcal{U}=\{1,\dots,5\}$（对应 FY1..FY5），无人机 $u$ 初始位置 $\mathbf{F}_u=(F_{u,x},F_{u,y},F_{u,z})$。
- 每架无人机最多投 $B_{\max}=3$ 枚弹；弹编号在同一架机上为 $b\in\{1,\dots,B_{\max}\}$（若少于 3 枚则相应位置不选）。
- 无人机轨迹（受命后在 $t=0$ 以恒速、恒向直线飞行）：
  - 速度 $v_u\in[v_{\min},v_{\max}]$（题中 $[70,140]$ m/s）；
  - 航向单位向量 $\mathbf{h}_u=(\cos\theta_u,\sin\theta_u,0)$；
  - 位置： $\mathbf{U}_u(t)=\mathbf{F}_u + v_u\,t\,\mathbf{h}_u$.
- 对每枚弹（由无人机 $u$ 的弹位 $b$ 决定）：
  - 释放时间 $t_{r,u,b}\ge0$；
  - 引信延迟（下落到起爆） $t_{d,u,b}>0$；
  - 起爆时间 $t_{e,u,b}=t_{r,u,b}+t_{d,u,b}$；
  - 释放点 $\mathbf{R}_{u,b}=\mathbf{U}_u(t_{r,u,b})$；
  - 起爆点：
    $$
    \mathbf{P}_{u,b}=\mathbf{R}_{u,b} + v_u\mathbf{h}_u\,t_{d,u,b} + (0,0,-\tfrac12 g t_{d,u,b}^2).
    $$
- 云团性质（同题设）：半径 $R_c=10$ m；下沉速率 $w=3$ m/s；持续时间 $T_c=20$ s。云团中心：
  $$
  \mathbf{C}_{u,b}(t)=\mathbf{P}_{u,b} + (0,0,-w(t-t_{e,u,b})),\quad t\in[t_{e,u,b},t_{e,u,b}+T_c].
  $$

## 2. 遮蔽判据（通用）
对于任意导弹 $j$，在时刻 $t$，令 $\mathbf{A}=\mathbf{M}_j(t)$，$\mathbf{B}=\mathbf{T}$，云团中心 $\mathbf{C}=\mathbf{C}_{u,b}(t)$。定义
- 投影系数
  $$
  \alpha_{u,b,j}(t)=\frac{(\mathbf{C}-\mathbf{A})\cdot(\mathbf{B}-\mathbf{A})}{\|\mathbf{B}-\mathbf{A}\|^2}.
  $$
- 最近点距离
  $$
  d_{u,b,j}(t)=\Big\|\mathbf{C}-(\mathbf{A}+\alpha_{u,b,j}(t)(\mathbf{B}-\mathbf{A}))\Big\|.
  $$
云团 $(u,b)$ 在时刻 $t$ 对导弹 $j$ 遮蔽当且仅当
$$
0\le\alpha_{u,b,j}(t)\le1\quad\text{且}\quad d_{u,b,j}(t)\le R_c.
$$

令指示函数
$$
\mathbb{I}_{u,b,j}(t)=
\begin{cases}
1, & \text{若在时刻 } t \text{ 云团 } (u,b) \text{ 对导弹 } j \text{ 遮蔽},\\
0, & \text{否则}
\end{cases}
$$

单云团对导弹 $j$ 的遮蔽集合为
$$
\mathcal{T}_{u,b,j}=\{t\in[t_{e,u,b},t_{e,u,b}+T_c]:\ \mathbb{I}_{u,b,j}(t)=1\}.
$$

对导弹 $j$ 的**并集遮蔽集合**（由所有无人机/弹贡献）：
$$
\mathcal{T}_{j} = \bigcup_{u\in\mathcal{U}}\bigcup_{b=1}^{B_{\max}} \mathcal{T}_{u,b,j}.
$$

其对应的遮蔽时长（时间测度）：
$$
T_{\text{cover},j} = \mu(\mathcal{T}_j).
$$

## 3. 优化目标（可选多种形式）
常见目标形式有：

### (A) 最大化加权总遮蔽时间（线性合成）
给定导弹权重 $w_j\ge0$（可相同，若无指定取 1），目标
$$
\max\; J_{\text{sum}} = \sum_{j\in\mathcal{M}} w_j\, T_{\text{cover},j}.
$$

### (B) 最大化最小遮蔽（鲁棒）
提高“最弱”导弹被遮蔽的时间：
$$
\max\; J_{\min} = \min_{j\in\mathcal{M}} T_{\text{cover},j}.
$$

### (C) 混合目标（例如优先保证最小遮蔽，然后最大总遮蔽）
可采用层次化或带罚函数的多目标方法：
$$
\max\; \lambda \min_j T_{\text{cover},j} + (1-\lambda)\sum_j T_{\text{cover},j}.
$$

（实现时可根据指挥需求选择 A/B/C 之一；下面以 A 为主要范式，但 MILP 可适配其他目标。）

## 4. 可行性与约束
- 每架无人机航速与航向一致全程不变：
  - $v_{\min}\le v_u\le v_{\max}$；
  - $\theta_u\in[0,2\pi)$；
- 释放时间与起爆时间：
  - $t_{r,u,b}\ge 0$；
  - $t_{e,u,b}=t_{r,u,b}+t_{d,u,b}\le t_{\text{hit},j}$（至少在相关导弹到达前起爆，或保证有干扰作用）；
- 同机投放间隔约束：
  $$
  |t_{r,u,b} - t_{r,u,b'}| \ge 1\ \text{s},\quad \forall u,\ \forall b\neq b'.
  $$
- 弹的起爆高度非负（或可允许落地起爆并特殊处理）：
  $$
  P_{u,b,z} \ge 0.
  $$
- 若考虑无人机与多枚弹质量约束、挂载数量限制、燃油/续航约束等，可加相应约束（此处题设只给了每架最多 3 枚的投放数量）。

## 5. 连续优化模型（精确但难求全局）
决策变量集合：
$$
\{v_u,\theta_u\}_{u\in\mathcal{U}},\quad \{t_{r,u,b},t_{d,u,b}\}_{u,b}.
$$
目标（例如 A）：
$$
\max \; J_{\text{sum}} = \sum_{j\in\mathcal{M}} w_j \cdot \mu\Bigg(\bigcup_{u}\bigcup_{b}\big\{t:\, \mathbb{I}_{u,b,j}(t)=1\big\}\Bigg).
$$
并受上述可行性约束约束。  
> 该连续模型是**非线性、非凸且目标非光滑（含 0/1 指示）**的混合优化问题，一般采用数值 / 黑盒优化或离散化近似求解。

## 6. 实用的离散化近似（候选事件 + 整数规划 / MILP）
为便于求解，常用两阶段策略：

### 阶段 1 — 候选事件生成（每架机独立）
对每架无人机 $u$，枚举或搜索若干可行的单弹事件（candidate event）：
- 事件变量： $(t_{r},t_{d},t_e,\mathbf{P},v_u,\theta_u)$（或参数化为 $(t_e,s)$ 其中 $\mathbf{P}=\mathbf{M}_j(t_e)+s(\mathbf{T}-\mathbf{M}_j(t_e))$）。
- 对每个候选事件，预计算并保存它对每个导弹 $j$ 的遮蔽时间区间集合 $\mathcal{T}_{\text{cand},j}$（离散化时间步上可记录被遮蔽的时间格）。
- 只保留能被无人机以某轨迹（$v_u,\theta_u$）实现且满足间隔、起爆高度等基本约束的候选事件。每架机最多保留前 $N$ 个高质量候选（按单事件遮蔽时长排序）以控制组合规模。

### 阶段 2 — 组合选择（整数规划）
- 索引：
  - 对所有 UAV-弹槽 $(u,b)$ 的候选事件集合为 $\mathcal{E}_{u,b}$（若把弹槽看成可选，或把候选事件与某 UAV 直接关联到 slot）。
  - 用二进制选择变量 $x_{e}\in\{0,1\}$ 表示是否选择候选事件 $e$（事件已隐含关联某个 UAV 与某个弹槽）。
- 预计算二进制遮蔽常量：对每时间格 $k$（网格化时域，步长 $\Delta t$），对于每导弹 $j$，若事件 $e$ 会在格 $k$ 遮蔽该导弹则记作 $b_{e,j,k}=1$，否则为 0。
- 引入时间格遮蔽变量：$y_{j,k}\in\{0,1\}$ 表示在时间格 $k$ 导弹 $j$ 被至少一枚选中事件遮蔽。
- 约束：
  1. 每个 UAV 的弹槽最多选择一次或一个弹槽上只能有一个事件（若事件编码含弹槽信息，则由事件集合自然保证每个弹槽最多一个事件）：
     $$
     \sum_{e\in\mathcal{E}_{u,b}} x_e \le 1,\quad \forall u,\forall b.
     $$
  2. 每架无人机最多使用 $B_{\max}$ 个弹槽（一般等于集合大小，或自然满足）。
  3. 时间格遮蔽与事件选择的关系（对于每导弹 $j$ 与每格 $k$）：
     $$
     \sum_{e} b_{e,j,k} x_e \ge y_{j,k},\qquad
     \sum_{e} b_{e,j,k} x_e \le M\, y_{j,k},
     $$
     其中 $M$ 为大数（或可省略第二式，若只需上界）。
- 目标（离散化后的加权总遮蔽）：
  $$
  \max\; \sum_{j\in\mathcal{M}} w_j \sum_{k} y_{j,k}\,\Delta t.
  $$

该整数规划是**0-1 ILP / MILP**（若轨迹速度/航向离散化为候选并由事件隐含，则模型为纯 0-1 ILP；若保留连续 $v_u$ 则为混合整数）。

## 7. 约束细化（用于 MILP）
- **同机间隔约束**（若候选事件时间格已编码释放时刻，则需保证同机的任意两选中事件释放格差 ≥ 1s）：
  - 记事件 $e$ 与 $e'$ 所在同一无人机 $u$ 的释放时间格为 $k_e,k_{e'}$，则可预计算禁止共选的事件对（若 $|k_e-k_{e'}|\Delta t < 1$ 则不能同时选）。用约束：
    $$
    x_e + x_{e'} \le 1 \quad \text{(for all forbidden pairs }(e,e')).
    $$
  - 这种“禁止对”写法避免绝对值非线性，简单且线性。
- **轨迹/速度可达性**：事件集合已按可达性筛选；若不预筛选，需将轨迹选项做为二进制变量并约束事件只能在所选轨迹下被选。

## 8. 求解策略建议
- **候选事件法（推荐）**：
  1. 对每架 UAV-弹槽 独立生成候选事件（在每个目标/时间窗口与 s 空间上采样），保留前 $N$（例如 N=20） 个最有价值事件；并把每事件映射为对每个导弹的离散遮蔽格集合 $b_{e,j,k}$。
  2. 构建上述 0-1 ILP 并用 Gurobi/CPLEX/SciPy 的 MIP 解算器求解全局最优组合（若组合规模大，可采用分支限界加启发式修剪）。
  3. 对求得的最优组合做局部连续微调（在每个被选事件的 $t_e$ 与 $s$ 附近用更细步长搜索或局部优化器调整）。
- **若不想离散化时间**，可采用元启发式（差分进化 / PSO / GA）直接在连续变量上搜索（把所有无人机与每弹槽变量当作连续决策），但需重复仿真评估目标且不保证全局最优性。
- **并行化**：候选事件生成与每事件对各导弹遮蔽时段的仿真评估天然可并行（每事件独立）。

## 9. 可选扩展
- 风场、烟幕稀释/扩散模型：把云团中心和半径扩展为随时间变化的浓度场 \(C(\mathbf{x},t)\)，并用浓度阈值判定遮蔽，需替换几何判据并增加蒙特卡洛或 PDE 仿真。
- 多目标 / 风险度量：优化最小覆盖、最大化覆盖概率（在存在随机风或引信不确定性时）。
- 资源/后勤约束：考虑每架机的剩余弹数量、返回基站时间、能耗等约束。
=